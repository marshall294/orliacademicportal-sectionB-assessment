<!-- teacher.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Teacher - Upload Assessment</title>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
  <style>
    body { font-family: Arial; padding: 2rem; background: #f0f8ff; }
    label, input, select, button { display: block; margin: 10px 0; }
    .answer-list { margin-top: 2rem; }
  </style>
</head>
<body>
  <h2>Upload Assessment</h2>
  <label>Class: <input id="classInput" placeholder="e.g. Primary 6" /></label>
  <label>Subject: <input id="subjectInput" placeholder="e.g. Mathematics" /></label>
  <label>Google Doc Link: <input id="docLinkInput" placeholder="Paste Google Doc link here" /></label>
  <button onclick="uploadAssessment()">Upload</button>

  <div class="answer-list">
    <h3>Student Submissions</h3>
    <div id="submissions"></div>
  </div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyAA3RgTVx8ypjD2MuUDW5wwGcXy5l9dHhw",
      authDomain: "year-6-f8090.firebaseapp.com",
      databaseURL: "https://year-6-f8090-default-rtdb.firebaseio.com",
      projectId: "year-6-f8090",
      storageBucket: "year-6-f8090.appspot.com",
      messagingSenderId: "1028033073339",
      appId: "1:1028033073339:web:d02448b0a41e559d40599e"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    function uploadAssessment() {
      const className = document.getElementById("classInput").value;
      const subject = document.getElementById("subjectInput").value;
      const link = document.getElementById("docLinkInput").value;
      if (!className || !subject || !link) return alert("Fill all fields");

      db.ref(`assessments/${className}/${subject}`).set({ link });
      alert("Assessment uploaded successfully");
    }

    function loadSubmissions() {
      db.ref("submissions").on("value", (snap) => {
        const data = snap.val();
        const container = document.getElementById("submissions");
        container.innerHTML = "";
        if (!data) return;
        Object.entries(data).forEach(([className, subjects]) => {
          Object.entries(subjects).forEach(([subject, submissions]) => {
            const div = document.createElement("div");
            div.innerHTML = `<strong>${className} - ${subject}</strong><ul>` +
              Object.entries(submissions).map(([name, link]) => `<li>${name}: <a href="${link}" target="_blank">View</a></li>`).join('') + '</ul>';
            container.appendChild(div);
          });
        });
      });
    }
    loadSubmissions();
  </script>
</body>
</html>
